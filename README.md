# SNMP Network Scanner & Analyzer

This script automates scanning, sniffing, parsing, and analyzing SNMPv3 data.

## Requirements
<!-- TODO: check if this is all -->
* **Python 3.x**
* **Python Libraries:** `pandas`, `ipwhois`, `tqdm` (`pip install pandas ipwhois tqdm`)
* **System Tools:** `zmap`, `tshark` (Wireshark)
* **Permissions:** Script often requires `sudo` for network operations (`zmap`, `tshark`).

## Project Structure

* `config/`: Holds essential (static) input files like `enterprise-numbers.txt`, `excluded_vendors.txt`, and `snmp3_161.pkt`.
* `outputs/`: Where all generated results and parsed data are stored.

## How to Use

The script operates in different modes via command-line arguments:

1.  **Scan Mode (`scan`)**: Performs a ZMap scan and TShark sniff simultaneously.
    * **Usage:** `sudo python3 script.py scan <path_to_ip_list_file>`
    * `<path_to_ip_list_file>`: A text file containing IP addresses to scan.

2.  **Parse TShark Output (`parse`)**: Parses raw TShark CSV output into a more structured format.
    * **Usage:** `python3 script.py parse <tshark_output_file_path>`
    * `<tshark_output_file_path>`: Path to a CSV file generated by TShark (e.g., in `outputs/tshark/`).

3.  **Enterprise Count Analysis (`enterprise_count`)**: Processes parsed data, filters, and generates vendor reports.
    * **Usage:** `python3 script.py enterprise_count <folder_with_parsed_csvs> <reboot_threshold_seconds>`
    * `<folder_with_parsed_csvs>`: Path to a folder containing parsed CSVs (e.g., `outputs/parsed/`).
    * `<reboot_threshold_seconds>`: An integer, only includes devices with uptime greater than this value in seconds.

4.  **Parse AS Results (`parse_asn`)**: Get ASN/WHOIS information for a list of IP's.
    * **Usage:** `python3 script.py parse_asn <path_to_ip_list_file>`
    * `<path_to_ip_list_file>`: The filepath to a textfile containing a column of IP addresses to get AS data for.

## Input Files

* `config/enterprise-numbers.txt`
* `config/excluded_vendors.txt`
* `config/snmp3_161.pkt` (ZMap probe payload for SNMPv3)
* IP list for `scan` mode.
* Generated CSVs from previous steps (e.g., TShark output for `parse` mode, parsed output for `enterprise_count` mode).

## Output Files

Generated in the `outputs/` directory and its subfolders (`outputs/zmap/`, `outputs/tshark/`, `outputs/parsed/`, `outputs/results/`):

* Raw TShark capture CSVs (`outputs/tshark/`)
* Raw ZMap scan result CSVs (`outputs/zmap/`)
* Enriched ZMap CSVs (`outputs/zmap/`)
* Parsed TShark output CSVs (`outputs/parsed/`)
* Consolidated and filtered enterprise reports (`outputs/results/`)
* Vendor count reports (`outputs/results/`)
* Reboot time filtered reports (`outputs/results/`)
